# üîó –ï–¥–∏–Ω—ã–π –±–∞–ª–∞–Ω—Å –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –±–æ—Ç–æ–≤

## ‚úÖ –•–æ—Ä–æ—à–∞—è –Ω–æ–≤–æ—Å—Ç—å!

–í–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ **–£–ñ–ï –ü–û–î–î–ï–†–ñ–ò–í–ê–ï–¢** –µ–¥–∏–Ω—ã–π –±–∞–ª–∞–Ω—Å –ø–æ Telegram ID!

---

## üéØ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:

```python
class User:
    id: int  # ‚Üê –≠—Ç–æ Telegram ID (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π –≥–ª–æ–±–∞–ª—å–Ω–æ!)
    balance_sol: float
    wallet_address: str
    ...
```

**Telegram ID —É–Ω–∏–∫–∞–ª–µ–Ω** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–æ –≤—Å—ë–º Telegram!

–≠—Ç–æ –∑–Ω–∞—á–∏—Ç:
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å ID `123456789` –±—É–¥–µ—Ç –æ–¥–Ω–∏–º –∏ —Ç–µ–º –∂–µ –≤–æ –í–°–ï–• –±–æ—Ç–∞—Ö
- ‚úÖ –ï—Å–ª–∏ –¥–≤–∞ –±–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç **–æ–¥–Ω—É –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö** ‚Üí –±–∞–ª–∞–Ω—Å –æ–±—â–∏–π!
- ‚úÖ –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ –æ–¥–Ω–æ–º –±–æ—Ç–µ ‚Üí –≤–∏–¥–Ω–æ –≤ –¥—Ä—É–≥–æ–º

---

## üîß –ö–∞–∫ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –±–æ—Ç–æ–≤ –∫ –æ–¥–Ω–æ–º—É –±–∞–ª–∞–Ω—Å—É

### –í–∞—Ä–∏–∞–Ω—Ç 1: –û–¥–Ω–∞ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

#### –ù–∞ Railway.app:

```
–ü—Ä–æ–µ–∫—Ç 1 (–ë–æ—Ç 1):
  ‚îî‚îÄ BOT_TOKEN=—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞_1
  ‚îî‚îÄ DATABASE_URL=postgresql://...  ‚Üê –¢–∞ –∂–µ –ë–î!

–ü—Ä–æ–µ–∫—Ç 2 (–ë–æ—Ç 2):
  ‚îî‚îÄ BOT_TOKEN=—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞_2
  ‚îî‚îÄ DATABASE_URL=postgresql://...  ‚Üê –¢–∞ –∂–µ –ë–î!
```

**–û–±–∞ –±–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–Ω—É PostgreSQL –±–∞–∑—É = –µ–¥–∏–Ω—ã–π –±–∞–ª–∞–Ω—Å!**

#### –ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:

1. **–°–æ–∑–¥–∞–π—Ç–µ PostgreSQL –Ω–∞ Railway** (–æ–¥–∏–Ω —Ä–∞–∑)
2. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ DATABASE_URL** –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ PostgreSQL
3. **–°–æ–∑–¥–∞–π—Ç–µ –≤—Ç–æ—Ä–æ–π –ø—Ä–æ–µ–∫—Ç** (–≤—Ç–æ—Ä–æ–π –±–æ—Ç)
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ—Ç –∂–µ DATABASE_URL** –¥–ª—è –æ–±–æ–∏—Ö –±–æ—Ç–æ–≤

---

## üí° –Ø –¥–æ–±–∞–≤–∏–ª Balance API

–Ø —Å–æ–∑–¥–∞–ª —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π API —Å–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–ª–∞–Ω—Å–æ–º –º–µ–∂–¥—É –±–æ—Ç–∞–º–∏!

### –§–∞–π–ª: `services/balance_api.py`

#### –§—É–Ω–∫—Ü–∏–∏:

```python
# –ü–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
balance_info = await balance_api.get_user_balance(session, telegram_id)

# –û–±–Ω–æ–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å –∏–∑ –¥—Ä—É–≥–æ–≥–æ –±–æ—Ç–∞
success = await balance_api.update_balance(
    session, 
    telegram_id, 
    amount_sol=0.1,
    description="–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∏–∑ –±–æ—Ç–∞ 2"
)

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
exists = await balance_api.check_user_exists(session, telegram_id)

# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
await balance_api.sync_user_info(session, telegram_id, username, first_name)
```

---

## üìã –ü—Ä–∏–º–µ—Ä –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–≤—É—Ö –±–æ—Ç–æ–≤

### –ë–æ—Ç 1 (–æ—Å–Ω–æ–≤–Ω–æ–π –º–∞–≥–∞–∑–∏–Ω):
```env
BOT_TOKEN=—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞_1
DATABASE_URL=postgresql://user:pass@host:5432/shared_db
ADMIN_IDS=123456789
...
```

### –ë–æ—Ç 2 (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π):
```env
BOT_TOKEN=—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞_2
DATABASE_URL=postgresql://user:pass@host:5432/shared_db  ‚Üê –¢–∞ –∂–µ –ë–î!
ADMIN_IDS=123456789
...
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç:

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ø–æ–ª–Ω—è–µ—Ç –±–∞–ª–∞–Ω—Å –≤ **–ë–æ—Ç–µ 1** ‚Üí –≤–∏–¥–∏—Ç –≤ **–ë–æ—Ç–µ 2**
- –ü–æ–∫—É–ø–∞–µ—Ç —Ç–æ–≤–∞—Ä –≤ **–ë–æ—Ç–µ 2** ‚Üí –±–∞–ª–∞–Ω—Å —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è –≤–µ–∑–¥–µ
- **Telegram ID** - –µ–¥–∏–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä

---

## üîó –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Balance API

### –í –¥—Ä—É–≥–æ–º –±–æ—Ç–µ:

```python
from database.database import db
from services.balance_api import balance_api

async def check_balance(telegram_id: int):
    async for session in db.get_session():
        # –ü–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å
        balance = await balance_api.get_user_balance(session, telegram_id)
        
        if balance:
            print(f"User {telegram_id}:")
            print(f"  Balance EUR: ‚Ç¨{balance['balance_eur']:.2f}")
            print(f"  Balance SOL: {balance['balance_sol']:.4f}")
            print(f"  Wallet: {balance['wallet_address']}")
```

---

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —ç—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### ‚úÖ –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

1. **Telegram ID –∫–∞–∫ –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á**
   - –ì–ª–æ–±–∞–ª—å–Ω–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π
   - –†–∞–±–æ—Ç–∞–µ—Ç –º–µ–∂–¥—É –±–æ—Ç–∞–º–∏

2. **–ï–¥–∏–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**
   - PostgreSQL –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
   - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è

3. **–ï–¥–∏–Ω—ã–π –∫–æ—à–µ–ª–µ–∫**
   - –ö–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å = –æ–¥–∏–Ω –∫–æ—à–µ–ª–µ–∫
   - –ù–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –±–æ—Ç–∞

4. **Balance API**
   - –ì–æ—Ç–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–ª–∞–Ω—Å–æ–º
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

---

## üìù –°—Ü–µ–Ω–∞—Ä–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä: –ì–ª–∞–≤–Ω—ã–π –±–æ—Ç + VIP –±–æ—Ç

**–ì–ª–∞–≤–Ω—ã–π –±–æ—Ç (@main_shop_bot)**:
- –û—Å–Ω–æ–≤–Ω–æ–π –∫–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤
- –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã

**VIP –±–æ—Ç (@vip_shop_bot)**:
- –≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã
- –¢–æ—Ç –∂–µ –±–∞–ª–∞–Ω—Å!
- –ü—Ä–µ–º–∏—É–º —Ñ—É–Ω–∫—Ü–∏–∏

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**:
1. –ü–æ–ø–æ–ª–Ω—è–µ—Ç –±–∞–ª–∞–Ω—Å –≤ **–≥–ª–∞–≤–Ω–æ–º –±–æ—Ç–µ**: ‚Ç¨50
2. –ü–æ–∫—É–ø–∞–µ—Ç —Ç–æ–≤–∞—Ä –≤ **–≥–ª–∞–≤–Ω–æ–º –±–æ—Ç–µ**: -‚Ç¨10 (–æ—Å—Ç–∞—Ç–æ–∫ ‚Ç¨40)
3. –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ **VIP –±–æ—Ç–∞**: –≤–∏–¥–∏—Ç –±–∞–ª–∞–Ω—Å ‚Ç¨40
4. –ü–æ–∫—É–ø–∞–µ—Ç VIP —Ç–æ–≤–∞—Ä: -‚Ç¨30 (–æ—Å—Ç–∞—Ç–æ–∫ ‚Ç¨10)
5. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ **–≥–ª–∞–≤–Ω—ã–π –±–æ—Ç**: –≤–∏–¥–∏—Ç –±–∞–ª–∞–Ω—Å ‚Ç¨10

**–í—Å—ë —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ!** ‚úÖ

---

## üõ†Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Ç–æ—Ä–æ–≥–æ –±–æ—Ç–∞

### –®–∞–≥ 1: –°–æ–∑–¥–∞–π—Ç–µ –≤—Ç–æ—Ä–æ–≥–æ –±–æ—Ç–∞

```
Telegram ‚Üí @BotFather ‚Üí /newbot ‚Üí —Å–æ–∑–¥–∞—Ç—å
–ü–æ–ª—É—á–∏—Ç—å –Ω–æ–≤—ã–π BOT_TOKEN
```

### –®–∞–≥ 2: –ü–æ–ª—É—á–∏—Ç–µ DATABASE_URL –æ—Ç –ø–µ—Ä–≤–æ–≥–æ –±–æ—Ç–∞

```
Railway ‚Üí –ø–µ—Ä–≤—ã–π –ø—Ä–æ–µ–∫—Ç ‚Üí PostgreSQL ‚Üí Variables ‚Üí DATABASE_URL
–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—É—é —Å—Ç—Ä–æ–∫—É
```

### –®–∞–≥ 3: –°–æ–∑–¥–∞–π—Ç–µ –≤—Ç–æ—Ä–æ–π –ø—Ä–æ–µ–∫—Ç –Ω–∞ Railway

```
1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ç–æ—Ç –∂–µ –∫–æ–¥ (–∏–ª–∏ –∫–æ–ø–∏—é)
2. New Project –Ω–∞ Railway
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ DATABASE_URL –æ—Ç –ü–ï–†–í–û–ì–û –±–æ—Ç–∞!
4. –£–∫–∞–∂–∏—Ç–µ –Ω–æ–≤—ã–π BOT_TOKEN
```

### –®–∞–≥ 4: –ì–æ—Ç–æ–≤–æ!

–û–±–∞ –±–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–Ω—É –±–∞–∑—É = –µ–¥–∏–Ω—ã–π –±–∞–ª–∞–Ω—Å!

---

## üí° –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### API —ç–Ω–¥–ø–æ–∏–Ω—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å REST API –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–∞–ª–∞–Ω—Å–∞:

```python
# api.py
from aiohttp import web
from database.database import db
from services.balance_api import balance_api

async def get_balance(request):
    telegram_id = int(request.match_info['telegram_id'])
    
    async for session in db.get_session():
        balance = await balance_api.get_user_balance(session, telegram_id)
        
        if balance:
            return web.json_response(balance)
        return web.json_response({'error': 'User not found'}, status=404)

app = web.Application()
app.router.add_get('/balance/{telegram_id}', get_balance)
```

–¢–æ–≥–¥–∞ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –±–∞–ª–∞–Ω—Å —á–µ—Ä–µ–∑ HTTP:
```
GET https://your-bot.railway.app/balance/123456789
```

---

## ‚úÖ –ò—Ç–æ–≥

**–°–∏—Å—Ç–µ–º–∞ –£–ñ–ï –ü–û–î–î–ï–†–ñ–ò–í–ê–ï–¢ –µ–¥–∏–Ω—ã–π –±–∞–ª–∞–Ω—Å!**

–ü—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
- –û–¥–∏–Ω PostgreSQL –¥–ª—è –≤—Å–µ—Ö –±–æ—Ç–æ–≤
- –†–∞–∑–Ω—ã–µ BOT_TOKEN –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–æ—Ç–∞
- –û–¥–∏–Ω DATABASE_URL –¥–ª—è –≤—Å–µ—Ö

**Telegram ID** - —ç—Ç–æ –≥–ª–æ–±–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä, –±–∞–ª–∞–Ω—Å –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –Ω–µ–º—É!

---

## üöÄ –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

–Ø —Å–æ–∑–¥–∞–ª **`services/balance_api.py`** —Å –≥–æ—Ç–æ–≤—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏:
- `get_user_balance()` - –ø–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å
- `update_balance()` - –æ–±–Ω–æ–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å
- `check_user_exists()` - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ
- `sync_user_info()` - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ

–ú–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ –º–µ—Ç–æ–¥—ã –≤ –¥—Ä—É–≥–∏—Ö –±–æ—Ç–∞—Ö!

---

**–§–∞–π–ª —Å–æ–∑–¥–∞–Ω**: `services/balance_api.py`  
**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: `–ï–î–ò–ù–´–ô_–ë–ê–õ–ê–ù–°.md`  

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**: –û–±–Ω–æ–≤–∏—Ç–µ –±–æ—Ç–∞ (`update_railway.bat`) –∏ —Å–∏—Å—Ç–µ–º–∞ –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç! üöÄ
